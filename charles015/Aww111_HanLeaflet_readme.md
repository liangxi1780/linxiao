一个基于leaflet的开源小项目，地图服务器使用的是geoserver。
用到了很多开源插件。
5.25更新
一、更新情况
1.	UI界面继续微调；
2.	继续完善了绘图功能（从github发现更好用的插件）；
3.	完成了基于WFS的模糊查询功能；
4.	完善了点击中国SHP图层，通过popup弹出层显示点击的图层的信息查询；
5.	完善了地理定位；
6.	修改了图层控制器；
二、功能介绍
1.	绘图功能借鉴了github插件，移动到地图右侧，可以添加各种图形并且可以编辑。
  
2.	基于WFS的模糊查询，例如，输入“江”，可以查出黑龙江，江苏，浙江，江西，其他同理。
 

3.	直接点击图层，可以查询出当前省份名称，并且通过popup显示；
 
这个查询操作是通过ajax发送查询，如下链接
“http://localhost:8060/geoserver/cite/wms?REQUEST=GetFeatureInfo&SERVICE=WMS&SRS=EPSG%3A4326&STYLES=&TRANSPARENT=true&VERSION=1.1.1&FORMAT=image%2Fpng&BBOX=68.1240226328373%2C32.04906019400166%2C129.0322257578373%2C51.057971386775115&HEIGHT=585&WIDTH=1386&LAYERS=cite%3Achina&QUERY_LAYERS=cite%3Achina&INFO_FORMAT=application%2Fjson&X=434&Y=145”来完成的，查询成功之后，会返回json字符串的结果，如下图所示。然后可以解析字符串，放到popup中即可。
 
4.	地理定位是基于获取当前ip地址，通过ip地址来获取地理坐标然后进行定位的一个操作。在右上角的图层管理器中，先移除中国shp图层，显示出天地图的底图，当前显示的位置是正确的。
 

5.	图层管理器，可以控制图层的显示。并且切换天地图矢量图层和卫星图层作为底图；
 
5.21更新
一、更新情况
1.	UI界面微调；
2.	增加地图定位；
3.	增加基于WFS服务的地图查询，这是一个重要的功能，对于一个webgis 系统来说，所有的增删改查全部就是基于wfs服务来进行的；
4.	增加了popu弹出层；
二、功能介绍
1.	增加地图定位。点击定位按钮，即可移动地图至坐标（128.28），长沙。
 
2.基于wfs服务的查询功能，输入如“北京市”，“湖南省”，“内蒙古自治区”，然后点击查询，即可查询到相应的省份，并且返回高亮。
 
 
 



3点击图片上任意位置，即可获得弹出框，显示点击位置坐标。这个弹出层最常出现的需求是：点击地图上的poi点，显示此点的相应信息。不过这个功能目前我还在查找中。目前只完成了这种简单的弹出层。
 
5.11 简单demo
访问地址：http://123.207.85.229:8080/open/index.html（打开直接访问，这是我自己的云服务器）
一、完成功能
（1）数据导入到pgsql数据库；
（2）geoserver发布pgsql数据库中的图层为wms；
（3）加载WMTS天地图图层；
（4）加载自己发布的wms图层；
（5）添加一个简单的绘图功能；
二、环境搭建
1.地图服务器：geoserver  2.12.2
2.数据库：postgresql+postgis  9.4
3.前端：openlayers 4
4.gis软件：qgis 2.18
5.备注：以上软件皆为开源，并且完成本地环境搭建；

三、数据处理
1.数据入库
	我自己手中有wgs84坐标系下的中国地图，可以把其先看成自有数据，通过postgis导入到postgressql中；
 
（我自己的shp格式的数据）

 
（导入到pgsql数据中的数据）






2.数据查看
	打开qgis软件，连接到数据库 ，打开导入的shp数据，说明数据导入到数据库中是没有问题的。在这里需要说明的是，qgis（或arcgis，udig等其他gis软件）是用来对数据进行编辑处理的，在数据库软件中肯定是无法对空间数据进行处理的。在实际开发中，如果数据已经编辑好的话，那么是可以不用gis（或arcgis，udig等其他gis软件）软件的。
 
（qgis软件可以正常打开pgsql数据中的数据）
3.数据发布
	使用geoserver对数据库中的地图数据进行发布
 
 
（geoserver发布数据成功，没有问题）
四、demo搭建
1.思路
	Demo搭建的思路很简单，1）以天地图的wmts数据源作为底图数据并显示；2）把自己发布的geoserver数据叠加到地图数据上，并且做到数据无偏移，这样的话，证明技术路线是正确的。
2.验证
	引入ol4前端框架，引入天地图的wmts服务中的注记图层和地图图层，再把自己发布的geoserver数据进行叠加即可。
 
（未加载自定义图层，只加载天地图底图）
 
（启动图层控制，加载自定义图层，证明叠加没有问题）
	数据叠加没有发生偏移，坐标系采用epsg：4326，说明此技术路线（geoserver+postgresql+qgis+openlayers）是正确的。




 # 良心友情链接

[腾讯QQ群快速检索](http://u.720life.cn/s/8cf73f7c)

[软件免费开发论坛](http://u.720life.cn/s/bbb01dc0)